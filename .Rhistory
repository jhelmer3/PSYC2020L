geom_line(aes(y = g1), color = "#b04c19", linewidth = 3) +
geom_line(aes(y = g2), color = "#5a55fa", linewidth = 3) +
geom_line(aes(y = g3), color = "#dfc127", linewidth = 3) +
geom_point(aes(x = x1, y = h_x1), dat, color = "#b04c19") +
geom_point(aes(x = x2, y = h_x2), dat, color = "#5a55fa") +
geom_point(aes(x = x3, y = h_x3), dat, color = "#dfc127") +
scale_x_continuous(breaks = c(0, 5, 10, 15)) +
coord_cartesian(xlim = c(0, 15), ylim = c(0, .5), expand = F) +
guides(y = "none", x = guide_axis(cap = "both")) +
labs(y = NULL, x = NULL) +
theme_classic(base_size = 20)
library(palmerpenguins)
head(penguins)
summary(penguins)
summary(penguins |> select(species, flipper_length_mm))
flipper_model <- aov(flipper_length_mm ~ species)
flipper_model <- aov(flipper_length_mm ~ species, data = penguins)
summary(flipper_model)
lme4::cake
?lme4::cake
data(cake, package="lme4")
force(cake)
cake
cake |> write.csv(here::here("labs", "Lab 14 - One-Way ANOVA", "cake_data.csv"))
cake <- rio::import(here::here("labs", "Lab 14 - One-Way ANOVA", "cake_data.csv"))
cake
aov(angle ~ recipe, data = cake) |> summary()
cake <- data.frame(cakeid = 1:100,
recipe = rep(c("A", "B", "C", "D"), each = 25))
View(cake)
c(rnorm(5, 0, 1), rnorm(5, 10, 0.1))
cake <- data.frame(cakeid = 1:100,
recipe = rep(c("A", "B", "C", "D"), each = 25),
angle = c(rnorm(25, 42, 5), rnorm(25, 30, 5), rnorm(25, 45, 5), rnorm(25, 35, 5)))
aov(angle ~ recipe, data = cake) |> summary()
cake |> write.csv(here::here("labs", "Lab 14 - One-Way ANOVA", "cake_data.csv"))
cake <- rio::import(here::here("labs", "Lab 14 - One-Way ANOVA", "cake_data.csv"))
aov(angle ~ recipe, data = cake) |> summary()
#| layout-ncol: 3
#| fig-width: 3
#| fig-height: 3
ggplot2::ggplot(data.frame(x = rnorm(1000)),
ggplot2::aes(x = x)) +
ggplot2::geom_histogram(bins = 12) +
ggplot2::coord_cartesian(xlim = c(-3.5, 3.5)) +
ggplot2::theme_bw(base_size = 14)
ggplot2::ggplot(data.frame(x = rnorm(1000, mean = 3)),
ggplot2::aes(x = x)) +
ggplot2::geom_histogram(bins = 12) +
ggplot2::coord_cartesian(xlim = c(-3.5, 3.5)) +
ggplot2::theme_bw(base_size = 14)
ggplot2::ggplot(data.frame(x = rnorm(1000, 4, 3)),
ggplot2::aes(x = log(x))) +
ggplot2::geom_histogram(bins = 12) +
ggplot2::coord_cartesian(xlim = c(-3.5, 3.5)) +
ggplot2::theme_bw(base_size = 14)
#| fig-width: 3
#| fig-height: 3
#| layout-ncol: 3
ggplot2::ggplot(data = data.frame(x = rnorm(10, 0, 1)), ggplot2::aes(x = x)) +
ggplot2::geom_histogram(ggplot2::aes(y = ggplot2::after_stat(density)),
bins = 12) +
ggplot2::stat_function(inherit.aes = FALSE, fun = dnorm,
n = 101, args = list(mean = 0, sd = 1),
color = "lightblue", linewidth = 2,
xlim = c(-3, 3)) +
ggplot2::coord_cartesian(xlim = c(-3, 3), ylim = c(0, 1)) +
ggplot2::labs(title = "n = 10") +
ggplot2::theme_classic()
ggplot2::ggplot(data = data.frame(x = rnorm(50, 0, 1)), ggplot2::aes(x = x)) +
ggplot2::geom_histogram(ggplot2::aes(y = ggplot2::after_stat(density)),
bins = 12) +
ggplot2::stat_function(inherit.aes = FALSE, fun = dnorm,
n = 101, args = list(mean = 0, sd = 1),
color = "lightblue", linewidth = 2,
xlim = c(-3, 3)) +
ggplot2::coord_cartesian(xlim = c(-3, 3), ylim = c(0, 1)) +
ggplot2::labs(title = "n = 50") +
ggplot2::theme_classic()
ggplot2::ggplot(data = data.frame(x = rnorm(500, 0, 1)), ggplot2::aes(x = x)) +
ggplot2::geom_histogram(ggplot2::aes(y = ggplot2::after_stat(density)),
bins = 12) +
ggplot2::stat_function(inherit.aes = FALSE, fun = dnorm,
n = 101, args = list(mean = 0, sd = 1),
color = "lightblue", linewidth = 2,
xlim = c(-3, 3)) +
ggplot2::coord_cartesian(xlim = c(-3, 3), ylim = c(0, 1)) +
ggplot2::labs(title = "n = 500") +
ggplot2::theme_classic()
pulse_data <- rio::import("http://www.statsci.org/data/oz/ms212.txt")
leaves <- rio::import(here::here("labs",
"Lab 12 - Chi-Squared Test",
"leaves.csv"))
table(leaves$color)
table(leaves$color) |>
chisq.test()
#| echo: false
library(tidyverse)
#| echo: false
#| fig-width: 3
#| fig-height: 4
#| fig-align: center
#| layout-ncol: 4
n <- 100
d1 <- data.frame(x = runif(n, 2, 8) + rnorm(n, 0, 1)) |>
mutate(y = x + rnorm(n, 0, 1))
d2 <- data.frame(x = runif(n, 2, 8) + rnorm(n, 0, 1)) |>
mutate(y = runif(n, 2, 8) + rnorm(n, 0, 1))
d3 <- data.frame(x = runif(n, 2, 8) + rnorm(n, 0, 1)) |>
mutate(y = .5* (x - 5)^2  + rnorm(n, 0, .1))
d4 <- data.frame(x = runif(n, 1, 9) + rnorm(n, 0, .5)) |>
mutate(y = 2.5 * sin(2 * x) + 5 + rnorm(n, 0, .2))
sctplt <- function(df) {
r <- cor(df$x, df$y)
df |>
ggplot(aes(x = x, y = y)) +
geom_point() +
scale_x_continuous(breaks = c(0, 5, 10), labels = c(0, 5, 10)) +
scale_y_continuous(breaks = c(0, 5, 10), labels = c(0, 5, 10)) +
coord_cartesian(xlim = c(0, 10), ylim = c(0, 10)) +
guides(y = guide_axis(cap = "both"), x = guide_axis(cap = "both")) +
labs(title = paste("*r* =", round(r, 2))) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1,
plot.title = ggtext::element_markdown(hjust = .5))
}
sctplt(d1)
sctplt(d2)
sctplt(d3)
sctplt(d4)
iris_small <- iris |>
select(Sepal.Length, Sepal.Width) |>
head(4)
iris_small
x_bar <- mean(iris_small$Sepal.Length)
x_sd <- sd(iris_small$Sepal.Length)
y_bar <- mean(iris_small$Sepal.Width)
y_sd <- sd(iris_small$Sepal.Width)
paste(x_bar, x_sd, y_bar, y_sd, sep = ", ")
iris_small <- iris_small |>
mutate(sq_diff_x = Sepal.Length - x_bar,
sq_diff_y = Sepal.Width - y_bar,
product = sq_diff_x * sq_diff_y)
iris_small
sum(iris_small$product) /
((nrow(iris_small) - 1) * x_sd * y_sd)
iris_small <- iris |>
select(Sepal.Length, Sepal.Width) |>
head(4)
iris_small
cor(iris_small$Sepal.Length,
iris_small$Sepal.Width)
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
iris |>
ggplot(aes(x = Sepal.Length, y = Sepal.Width)) +
geom_point(alpha = .5, shape = 16) +
geom_point(data = head(iris, 4), fill = "salmon3", color = "salmon", size = 3.3, shape = 23) +
scale_x_continuous(breaks = c(4, 6, 8), labels = c(4, 6, 8)) +
scale_y_continuous(breaks = c(1, 3, 5), labels = c(1, 3, 5)) +
coord_cartesian(xlim = c(4, 8), ylim = c(1, 5)) +
guides(y = guide_axis(cap = "both"), x = guide_axis(cap = "both")) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
cor(iris$Sepal.Length, iris$Sepal.Width)
#| echo: false
#| fig-width: 3
#| fig-height: 3
#| fig-align: center
#| layout-ncol: 3
n <- 20
d1 <- data.frame(x = runif(n, 2, 8) + rnorm(n, 0, 1)) |>
mutate(y = runif(n, 2, 8) + 2 + rnorm(n, 0, 1))
d2 <- data.frame(x = runif(n, 2, 8) + rnorm(n, 0, 1)) |>
mutate(y = runif(n, 2, 8) + rnorm(n, 0, 1))
d3 <- data.frame(x = runif(n, 2, 8) + rnorm(n, 0, 1)) |>
mutate(y = runif(n, 2, 8) + -2 + rnorm(n, 0, 1))
sctplt_mean <- function(df) {
df |>
ggplot(aes(x = x, y = y)) +
geom_point() +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = c(0, 5, 10), labels = c(0, 5, 10)) +
coord_cartesian(xlim = c(0, 10), ylim = c(0, 10)) +
guides(y = guide_axis(cap = "both"), x = "none") +
labs(x = NULL) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
}
sctplt_mean(d1)
sctplt_mean(d2)
sctplt_mean(d3)
#| echo: false
#| fig-width: 3
#| fig-height: 3
#| fig-align: center
#| layout-ncol: 3
sctplt_mean(d1) +
geom_hline(aes(yintercept = mean(y)), color = "salmon") +
geom_point()
sctplt_mean(d2) +
geom_hline(aes(yintercept = mean(y)), color = "salmon") +
geom_point()
sctplt_mean(d3) +
geom_hline(aes(yintercept = mean(y)), color = "salmon") +
geom_point()
#| echo: false
#| fig-width: 3
#| fig-height: 3
#| fig-align: center
#| layout-ncol: 3
sctplt_mean(d1) +
geom_hline(aes(yintercept = mean(y)), color = "salmon") +
geom_segment(aes(y = y, yend = mean(y)), color = "salmon", linetype = "dashed") +
geom_point()
sctplt_mean(d2) +
geom_hline(aes(yintercept = mean(y)), color = "salmon") +
geom_segment(aes(y = y, yend = mean(y)), color = "salmon", linetype = "dashed") +
geom_point()
sctplt_mean(d3) +
geom_hline(aes(yintercept = mean(y)), color = "salmon") +
geom_segment(aes(y = y, yend = mean(y)), color = "salmon", linetype = "dashed") +
geom_point()
#| echo: false
#| fig-width: 3
#| fig-height: 3
#| fig-align: center
#| layout-ncol: 3
sctplt_mean(d1) +
geom_hline(aes(yintercept = mean(y)), color = "salmon") +
geom_segment(aes(y = y, yend = mean(y)), color = "salmon", linetype = "dashed") +
geom_point()
sctplt_mean(d2) +
geom_hline(aes(yintercept = mean(y)), color = "salmon") +
geom_segment(aes(y = y, yend = mean(y)), color = "salmon", linetype = "dashed") +
geom_point()
sctplt_mean(d3) +
geom_hline(aes(yintercept = mean(y)), color = "salmon") +
geom_segment(aes(y = y, yend = mean(y)), color = "salmon", linetype = "dashed") +
geom_point()
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
n <- 30
d1 <- data.frame(x = runif(n, 2, 8) + rnorm(n, 0, 1)) |>
mutate(y = x + rnorm(n, 0, 1))
sctplt_reg <- function(df) {
df |>
ggplot(aes(x = x, y = y)) +
geom_point() +
scale_x_continuous(breaks = c(0, 5, 10), labels = c(0, 5, 10)) +
scale_y_continuous(breaks = c(0, 5, 10), labels = c(0, 5, 10)) +
coord_cartesian(xlim = c(0, 10), ylim = c(0, 10)) +
guides(y = guide_axis(cap = "both"), x = guide_axis(cap = "both")) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1,
plot.title = ggtext::element_markdown(hjust = .5))
}
sctplt_reg(d1)
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
sctplt_reg(d1)  +
geom_segment(aes(x = 0, xend = 10, y = mean(x)), color = "salmon") +
geom_segment(aes(x = 0, xend = 10, y = 0, yend = 10), color = "salmon") +
geom_segment(aes(x = 0, xend = 10, y = 2, yend = 8), color = "salmon") +
geom_segment(aes(x = 0, xend = 10, y = 5, yend = 7), color = "salmon") +
geom_point()
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
library(palmerpenguins)
p <- penguins |>
ggplot(aes(y = body_mass_g, x = 0)) +
geom_jitter() +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000)) +
guides(y = guide_axis(cap = "both"), x = "none") +
labs(x = NULL) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
p
p <- penguins |>
ggplot(aes(y = body_mass_g, x = 0)) +
geom_jitter() +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000)) +
#guides(y = guide_axis(cap = "both"), x = "none") +
labs(x = NULL) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
p
p <- penguins |>
ggplot(aes(y = body_mass_g, x = 0)) +
geom_jitter() +
#scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000)) +
#guides(y = guide_axis(cap = "both"), x = "none") +
labs(x = NULL) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
p
p <- penguins |>
ggplot(aes(y = body_mass_g, x = 0)) +
geom_jitter() +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000), xlim = c(-0.4, 0.5)) +
guides(y = guide_axis(cap = "both"), x = "none") +
labs(x = NULL) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
p
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
p + geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5) +
stat_summary(aes(x = .52, y = mean(body_mass_g, na.rm=T),
label = mean(body_mass_g, na.rm=T) |> round(1)), geom = "text",
fun = mean, vjust = -.45, color = "seagreen3", size = 6)
p <- penguins |>
ggplot(aes(y = body_mass_g, x = 0)) +
geom_jitter() +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000), xlim = c(-0.4, 0.55)) +
guides(y = guide_axis(cap = "both"), x = "none") +
labs(x = NULL) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
p
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
p + geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5) +
stat_summary(aes(x = .52, y = mean(body_mass_g, na.rm=T),
label = mean(body_mass_g, na.rm=T) |> round(1)), geom = "text",
fun = mean, vjust = -.45, color = "seagreen3", size = 6)
p <- penguins |>
ggplot(aes(y = body_mass_g, x = 0)) +
geom_jitter() +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000), xlim = c(-0.4, 0.6)) +
guides(y = guide_axis(cap = "both"), x = "none") +
labs(x = NULL) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
p + geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5) +
stat_summary(aes(x = .52, y = mean(body_mass_g, na.rm=T),
label = mean(body_mass_g, na.rm=T) |> round(1)), geom = "text",
fun = mean, vjust = -.45, color = "seagreen3", size = 6)
summary(penguins_m1)$coefficients
penguins_m1 <- lm(body_mass_g ~ flipper_length_mm, data = penguins)
summary(penguins_m1)
summary(penguins_m1)
summary(penguins_m1)$coefficients
summary(penguins_m1)$r.squared
?summary.lm
predict(penguins_m1, newdata = data.frame(flipper_length_mm = seq(170, 240, 1))) |>
head(100)
predict(penguins_m1, newdata = data.frame(flipper_length_mm = seq(170, 240, 1))) |>
head(50)
predict(penguins_m1, newdata = data.frame(flipper_length_mm = seq(170, 240, 1))) |>
head(32)
?lighten
scales::col_lighter("salmon")
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
sctplt_reg(d1)  +
geom_segment(aes(x = 0, xend = 10, y = mean(x)), color = "salmon") +
geom_segment(aes(x = 0, xend = 10, y = 0, yend = 10), color = "salmon") +
geom_segment(aes(x = 0, xend = 10, y = 2, yend = 8), color = "salmon") +
geom_segment(aes(x = 0, xend = 10, y = 5, yend = 7), color = "salmon") +
geom_point()
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
sctplt_reg(d1)  +
geom_segment(aes(x = 0, xend = 10, y = mean(x)), color = "salmon") +
geom_segment(aes(x = 0, xend = 10, y = 0, yend = 10), color = "salmon") +
geom_segment(aes(x = 0, xend = 10, y = 2, yend = 8), color = "salmon") +
geom_segment(aes(x = 0, xend = 10, y = -2, yend = 12), color = "salmon") +
geom_point()
??tibb;e
??tibble
tibble(variable = c("ID", "brier1", "brier2", "bn_score", "crt_score", "ns_score", "cfs_score"),
description = c("Participant identifier", "Average Brier Score (lower = more accurate) at Time 1",
"Average Brier Score (lower = more accurate) at Time 2",
"Berlin Numeracy Score (Measure of Numerical Reasoning, higher = better)",
"Cognitive Reflection Test Score (A different measure of reasoning, higher = better)",
"Number Series Score (Numerical Pattern Matching, higher = better)",
"Coherence Score (Ability to follow the logic of probability, higher = better)"))
tibble::tibble(variable = c("ID", "brier1", "brier2", "bn_score", "crt_score", "ns_score", "cfs_score"),
description = c("Participant identifier", "Average Brier Score (lower = more accurate) at Time 1",
"Average Brier Score (lower = more accurate) at Time 2",
"Berlin Numeracy Score (Measure of Numerical Reasoning, higher = better)",
"Cognitive Reflection Test Score (A different measure of reasoning, higher = better)",
"Number Series Score (Numerical Pattern Matching, higher = better)",
"Coherence Score (Ability to follow the logic of probability, higher = better)"))
?tibble
data.frame(variable = c("ID", "brier1", "brier2", "bn_score", "crt_score", "ns_score", "cfs_score"),
description = c("Participant identifier", "Average Brier Score (lower = more accurate) at Time 1",
"Average Brier Score (lower = more accurate) at Time 2",
"Berlin Numeracy Score (Measure of Numerical Reasoning, higher = better)",
"Cognitive Reflection Test Score (A different measure of reasoning, higher = better)",
"Number Series Score (Numerical Pattern Matching, higher = better)",
"Coherence Score (Ability to follow the logic of probability, higher = better)"))
knitr::kable(info)
info <- data.frame(variable = c("ID", "brier1", "brier2", "bn_score", "crt_score", "ns_score", "cfs_score"),
description = c("Participant identifier", "Average Brier Score (lower = more accurate) at Time 1",
"Average Brier Score (lower = more accurate) at Time 2",
"Berlin Numeracy Score (Measure of Numerical Reasoning, higher = better)",
"Cognitive Reflection Test Score (A different measure of reasoning, higher = better)",
"Number Series Score (Numerical Pattern Matching, higher = better)",
"Coherence Score (Ability to follow the logic of probability, higher = better)"))
knitr::kable(info)
dat <- rio::import(here::here("exam", "forecasting_data.csv"))
dat <- rio::import(here::here("exam", "forecasting data.csv"))
head(dat)
str(dat)
names(dat)
dat |>
ggplot(aes(x = cfs_score, y = crt_score)) +
geom_point()
library(tidyverse)
dat |>
ggplot(aes(x = cfs_score, y = crt_score)) +
geom_point()
cor(dat$cfs_score, dat$crt_score)
cor.test(dat$cfs_score, dat$crt_score)
cor(dat$cfs_score, dat$bn_score, dat$crt_score, dat$ns_score)
dat |>
select(cfs_score, bn_score, crt_score, ns_score)
dat |>
select(cfs_score, bn_score, crt_score, ns_score) |>
cor()
lm(cfs_score ~ crt_score, data = dat)
lm(cfs_score ~ crt_score, data = dat) |>
summary()
dat <- dat |>
mutate(cfs_score_z = (cfs_score - mean(cfs_score)) / sd(cfs_score),
crt_score_z = (crt_score - mean(crt_score)) / sd(crt_score))
View(dat)
brier1_mean <- mean(dat$brier1)
brier2_mean <- mean(dat$brier2)
brier2_mean - brier1_mean
brier1_mean <- mean(dat$brier1)
brier2_mean <- mean(dat$brier2)
brier1_mean
brier2_mean
brier2_mean - brier1_mean
dat <- dat |>
mutate(brier_diff = brier2 - brier1)
mean(dat$brier_diff)
sd(dat$brier_diff)
sd(dat$brier_diff) / sqrt(nrow(dat) - 1)
t.test(dat$brier_diff)
-0.1187311/ 0.1511031
t.test(dat$brier_diff, var.equal = T)
sqrt(nrow(dat) - 1)
t.test(dat$brier1, dat$brier2, var.equal = T, paired = T)
sd(dat$brier_diff) / sqrt(nrow(dat))
mean(dat$brier_diff) / (sd(dat$brier_diff) / sqrt(nrow(dat)))
qt(.95, 174)
View(dat)
dat |> summary()
m <- lm(cfs_score ~ crt_score, data = dat)
summary(m)
predict(m, newdata = data.frame(crt_score = c(2, 4, 6)))
dat |>
ggplot(aes(x = crt_score, y = cfs_score)) +
geom_point()
predicted_data <- data.frame(crt_score = seq(0, 7, length.out = 100))
predicted_data <- data.frame(crt_score = seq(0, 7, length.out = 100)) |>
mutate(cfs_score_pred = predict(m, newdata = data.frame(crt_score)))
dat |>
ggplot(aes(x = crt_score, y = cfs_score)) +
geom_point() +
geom_line(data = predicted_data)
dat |>
ggplot(aes(x = crt_score, y = cfs_score)) +
geom_point() +
geom_line(data = predicted_data,
aes(y = cfs_score_pred))
predicted_data <- data.frame(crt_score = seq(0, 7)) |>
mutate(cfs_score_pred = predict(m, newdata = data.frame(crt_score)))
dat |>
ggplot(aes(x = crt_score, y = cfs_score)) +
geom_point() +
geom_line(data = predicted_data,
aes(y = cfs_score_pred))
