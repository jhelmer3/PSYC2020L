scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000), xlim = c(-0.4, 0.5)) +
guides(y = guide_axis(cap = "both"), x = "none") +
labs(x = NULL) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
p
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
p + geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5) +
stat_summary(aes(x = .52, y = mean(body_mass_g, na.rm=T),
label = mean(body_mass_g, na.rm=T) |> round(1)), geom = "text",
fun = mean, vjust = -.45, color = "seagreen3", size = 6)
p <- penguins |>
ggplot(aes(y = body_mass_g, x = 0)) +
geom_jitter() +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000), xlim = c(-0.4, 0.55)) +
guides(y = guide_axis(cap = "both"), x = "none") +
labs(x = NULL) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
p
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
p + geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5) +
stat_summary(aes(x = .52, y = mean(body_mass_g, na.rm=T),
label = mean(body_mass_g, na.rm=T) |> round(1)), geom = "text",
fun = mean, vjust = -.45, color = "seagreen3", size = 6)
p <- penguins |>
ggplot(aes(y = body_mass_g, x = 0)) +
geom_jitter() +
scale_x_continuous(breaks = NULL) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000), xlim = c(-0.4, 0.6)) +
guides(y = guide_axis(cap = "both"), x = "none") +
labs(x = NULL) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
p + geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5) +
stat_summary(aes(x = .52, y = mean(body_mass_g, na.rm=T),
label = mean(body_mass_g, na.rm=T) |> round(1)), geom = "text",
fun = mean, vjust = -.45, color = "seagreen3", size = 6)
summary(penguins_m1)$coefficients
penguins_m1 <- lm(body_mass_g ~ flipper_length_mm, data = penguins)
summary(penguins_m1)
summary(penguins_m1)
summary(penguins_m1)$coefficients
summary(penguins_m1)$r.squared
?summary.lm
predict(penguins_m1, newdata = data.frame(flipper_length_mm = seq(170, 240, 1))) |>
head(100)
predict(penguins_m1, newdata = data.frame(flipper_length_mm = seq(170, 240, 1))) |>
head(50)
predict(penguins_m1, newdata = data.frame(flipper_length_mm = seq(170, 240, 1))) |>
head(32)
?lighten
scales::col_lighter("salmon")
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
sctplt_reg(d1)  +
geom_segment(aes(x = 0, xend = 10, y = mean(x)), color = "salmon") +
geom_segment(aes(x = 0, xend = 10, y = 0, yend = 10), color = "salmon") +
geom_segment(aes(x = 0, xend = 10, y = 2, yend = 8), color = "salmon") +
geom_segment(aes(x = 0, xend = 10, y = 5, yend = 7), color = "salmon") +
geom_point()
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
sctplt_reg(d1)  +
geom_segment(aes(x = 0, xend = 10, y = mean(x)), color = "salmon") +
geom_segment(aes(x = 0, xend = 10, y = 0, yend = 10), color = "salmon") +
geom_segment(aes(x = 0, xend = 10, y = 2, yend = 8), color = "salmon") +
geom_segment(aes(x = 0, xend = 10, y = -2, yend = 12), color = "salmon") +
geom_point()
??tibb;e
??tibble
tibble(variable = c("ID", "brier1", "brier2", "bn_score", "crt_score", "ns_score", "cfs_score"),
description = c("Participant identifier", "Average Brier Score (lower = more accurate) at Time 1",
"Average Brier Score (lower = more accurate) at Time 2",
"Berlin Numeracy Score (Measure of Numerical Reasoning, higher = better)",
"Cognitive Reflection Test Score (A different measure of reasoning, higher = better)",
"Number Series Score (Numerical Pattern Matching, higher = better)",
"Coherence Score (Ability to follow the logic of probability, higher = better)"))
tibble::tibble(variable = c("ID", "brier1", "brier2", "bn_score", "crt_score", "ns_score", "cfs_score"),
description = c("Participant identifier", "Average Brier Score (lower = more accurate) at Time 1",
"Average Brier Score (lower = more accurate) at Time 2",
"Berlin Numeracy Score (Measure of Numerical Reasoning, higher = better)",
"Cognitive Reflection Test Score (A different measure of reasoning, higher = better)",
"Number Series Score (Numerical Pattern Matching, higher = better)",
"Coherence Score (Ability to follow the logic of probability, higher = better)"))
?tibble
data.frame(variable = c("ID", "brier1", "brier2", "bn_score", "crt_score", "ns_score", "cfs_score"),
description = c("Participant identifier", "Average Brier Score (lower = more accurate) at Time 1",
"Average Brier Score (lower = more accurate) at Time 2",
"Berlin Numeracy Score (Measure of Numerical Reasoning, higher = better)",
"Cognitive Reflection Test Score (A different measure of reasoning, higher = better)",
"Number Series Score (Numerical Pattern Matching, higher = better)",
"Coherence Score (Ability to follow the logic of probability, higher = better)"))
knitr::kable(info)
info <- data.frame(variable = c("ID", "brier1", "brier2", "bn_score", "crt_score", "ns_score", "cfs_score"),
description = c("Participant identifier", "Average Brier Score (lower = more accurate) at Time 1",
"Average Brier Score (lower = more accurate) at Time 2",
"Berlin Numeracy Score (Measure of Numerical Reasoning, higher = better)",
"Cognitive Reflection Test Score (A different measure of reasoning, higher = better)",
"Number Series Score (Numerical Pattern Matching, higher = better)",
"Coherence Score (Ability to follow the logic of probability, higher = better)"))
knitr::kable(info)
dat <- rio::import(here::here("exam", "forecasting_data.csv"))
dat <- rio::import(here::here("exam", "forecasting data.csv"))
head(dat)
str(dat)
names(dat)
dat |>
ggplot(aes(x = cfs_score, y = crt_score)) +
geom_point()
library(tidyverse)
dat |>
ggplot(aes(x = cfs_score, y = crt_score)) +
geom_point()
cor(dat$cfs_score, dat$crt_score)
cor.test(dat$cfs_score, dat$crt_score)
cor(dat$cfs_score, dat$bn_score, dat$crt_score, dat$ns_score)
dat |>
select(cfs_score, bn_score, crt_score, ns_score)
dat |>
select(cfs_score, bn_score, crt_score, ns_score) |>
cor()
lm(cfs_score ~ crt_score, data = dat)
lm(cfs_score ~ crt_score, data = dat) |>
summary()
dat <- dat |>
mutate(cfs_score_z = (cfs_score - mean(cfs_score)) / sd(cfs_score),
crt_score_z = (crt_score - mean(crt_score)) / sd(crt_score))
View(dat)
brier1_mean <- mean(dat$brier1)
brier2_mean <- mean(dat$brier2)
brier2_mean - brier1_mean
brier1_mean <- mean(dat$brier1)
brier2_mean <- mean(dat$brier2)
brier1_mean
brier2_mean
brier2_mean - brier1_mean
dat <- dat |>
mutate(brier_diff = brier2 - brier1)
mean(dat$brier_diff)
sd(dat$brier_diff)
sd(dat$brier_diff) / sqrt(nrow(dat) - 1)
t.test(dat$brier_diff)
-0.1187311/ 0.1511031
t.test(dat$brier_diff, var.equal = T)
sqrt(nrow(dat) - 1)
t.test(dat$brier1, dat$brier2, var.equal = T, paired = T)
sd(dat$brier_diff) / sqrt(nrow(dat))
mean(dat$brier_diff) / (sd(dat$brier_diff) / sqrt(nrow(dat)))
qt(.95, 174)
View(dat)
dat |> summary()
m <- lm(cfs_score ~ crt_score, data = dat)
summary(m)
predict(m, newdata = data.frame(crt_score = c(2, 4, 6)))
dat |>
ggplot(aes(x = crt_score, y = cfs_score)) +
geom_point()
predicted_data <- data.frame(crt_score = seq(0, 7, length.out = 100))
predicted_data <- data.frame(crt_score = seq(0, 7, length.out = 100)) |>
mutate(cfs_score_pred = predict(m, newdata = data.frame(crt_score)))
dat |>
ggplot(aes(x = crt_score, y = cfs_score)) +
geom_point() +
geom_line(data = predicted_data)
dat |>
ggplot(aes(x = crt_score, y = cfs_score)) +
geom_point() +
geom_line(data = predicted_data,
aes(y = cfs_score_pred))
predicted_data <- data.frame(crt_score = seq(0, 7)) |>
mutate(cfs_score_pred = predict(m, newdata = data.frame(crt_score)))
dat |>
ggplot(aes(x = crt_score, y = cfs_score)) +
geom_point() +
geom_line(data = predicted_data,
aes(y = cfs_score_pred))
#| column: screen
penguins_m0 <- lm(body_mass_g ~ 1, data = penguins)
library(palmerpenguins)
#| column: screen
penguins_m0 <- lm(body_mass_g ~ 1, data = penguins)
summary(penguins_m0)
predict(penguins_m0)
predict(penguins_m0) |>
head(32)
mean(penguins$body_mass_g, na.rm = T) |> round(3)
newdata <- data.frame(flipper_length_mm = seq(170, 240, 1))
head(newdata)
predict(penguins_m1, newdata = newdata) |>
head(32)
penguins_m1 <- lm(body_mass_g ~ flipper_length_mm, data = penguins)
summary(penguins_m1)
newdata <- data.frame(flipper_length_mm = seq(170, 240, 1))
head(newdata)
predict(penguins_m1, newdata = newdata) |>
head(32)
newdata <- data.frame(flipper_length_mm = 170:240)
head(newdata, 50)
penguins |> select(flipper_length_mm) |> range()
library(tidyverse)
penguins |> select(flipper_length_mm) |> range()
penguins |> select(flipper_length_mm) |> range(na.rm = T)
```{r}
length(predict(penguins_m0))
nrow(penguins)
nrow(drop_na(penguins))
nrow(!is.na(penguins))
nrow(drop_na(penguins))
length(penguins$body_mass_g)
length(is.na(penguins$body_mass_g))
length(!is.na(penguins$body_mass_g))
sum(!is.na(penguins$body_mass_g))
penguins |> select(body_mass_g) |> drop_na()
penguins |> select(body_mass_g) |> drop_na() |> nrow()
predict(penguins_m0) |>
head(16)
predict(penguins_m0) |>
head(16) |>
c()
predict(penguins_m0) |>
head(16) |>
unname()
100-30
70-15
penguins_m2 <- lm(body_mass_g ~ flipper_length_mm + bill_length_mm, data = penguins)
summary(penguins_m2)
ggeffects::ggpredict(penguins_m2)
ggeffects::ggpredict(penguins_m2) |> ggplot()
ggeffects::ggpredict(penguins_m2) |> as.data.frame()
ggeffects::ggpredict(penguins_m2) |> plot()
penguins |> summary()
predicted_data <- data.frame(flipper_length_mm = 170:240,
bill_length_mm = 30:60)|>
mutate(predicted_body_mass = predict(penguins_m1, newdata = expand_grid(flipper_length_mm,
bill_length_mm)))
expand_grid(flipper_length_mm, bill_length_mm)
data.frame(flipper_length_mm = 170:240,
bill_length_mm = 30:60)
expand_grid(flipper_length_mm = 170:240,
bill_length_mm = 30:60)
expand_grid(flipper_length_mm = 170:240,
bill_length_mm = 30:60) |>
as.data.frame()
expand_grid(flipper_length_mm = 170:240,
bill_length_mm = 30:60) |>
mutate(predicted_body_mass = predict(penguins_m1, newdata = data.frame(flipper_length_mm,
bill_length_mm)))
expand_grid(flipper_length_mm = 170:240,
bill_length_mm = 30:60) |>
mutate(predicted_body_mass = predict(penguins_m2, newdata = data.frame(flipper_length_mm,
bill_length_mm)))
predicted_data <- expand_grid(flipper_length_mm = 170:240,
bill_length_mm = 30:60) |>
mutate(predicted_body_mass = predict(penguins_m2, newdata = data.frame(flipper_length_mm,
bill_length_mm)))
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
penguins |>
ggplot(aes(y = body_mass_g, x = flipper_length_mm)) +
geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5, alpha = .33,
linetype = "dashed") +
geom_point() +
geom_line(data = predicted_data,
aes(x = flipper_length_mm, y = predicted_body_mass),
color = "seagreen3", linewidth = 1.5) +
scale_x_continuous(breaks = c(170, 210, 250)) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000), xlim = c(170, 250), clip = "off") +
guides(y = guide_axis(cap = "both"), x = guide_axis(cap = "both")) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
penguins |>
ggplot(aes(y = body_mass_g, x = flipper_length_mm)) +
geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5, alpha = .33,
linetype = "dashed") +
geom_point() +
geom_line(data = predicted_data,
aes(x = bill_length_mm, y = predicted_body_mass),
color = "seagreen3", linewidth = 1.5) +
scale_x_continuous(breaks = c(170, 210, 250)) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000), xlim = c(170, 250), clip = "off") +
guides(y = guide_axis(cap = "both"), x = guide_axis(cap = "both")) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
penguins |>
ggplot(aes(y = body_mass_g, x = bill_length_mm)) +
geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5, alpha = .33,
linetype = "dashed") +
geom_point() +
geom_line(data = predicted_data,
aes(x = bill_length_mm, y = predicted_body_mass),
color = "seagreen3", linewidth = 1.5) +
scale_x_continuous(breaks = c(170, 210, 250)) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000), xlim = c(170, 250), clip = "off") +
guides(y = guide_axis(cap = "both"), x = guide_axis(cap = "both")) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
penguins |>
ggplot(aes(y = body_mass_g, x = bill_length_mm)) +
geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5, alpha = .33,
linetype = "dashed") +
geom_point() +
geom_line(data = predicted_data,
aes(x = bill_length_mm, y = predicted_body_mass),
color = "seagreen3", linewidth = 1.5) +
scale_x_continuous(breaks = c(170, 210, 250)) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
#coord_cartesian(ylim = c(2000, 7000), xlim = c(170, 250), clip = "off") +
guides(y = guide_axis(cap = "both"), x = guide_axis(cap = "both")) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
penguins |>
ggplot(aes(y = body_mass_g, x = bill_length_mm)) +
geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5, alpha = .33,
linetype = "dashed") +
geom_point()
penguins |>
ggplot(aes(y = body_mass_g, x = bill_length_mm)) +
geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5, alpha = .33,
linetype = "dashed") +
geom_point() +
geom_line(data = predicted_data,
aes(x = bill_length_mm, y = predicted_body_mass),
color = "seagreen3", linewidth = 1.5) +
scale_x_continuous(breaks = c(170, 210, 250)) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
#coord_cartesian(ylim = c(2000, 7000), xlim = c(170, 250), clip = "off") +
guides(y = guide_axis(cap = "both"), x = guide_axis(cap = "both")) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
predicted_data
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
ggeffects::ggeffect(penguins_m2)
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
ggeffects::ggeffect(penguins_m2) |>
ggplot()
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
ggeffects::ggeffect(penguins_m2) |>
plot()
predicted_data_fl <- data.frame(flipper_length_mm = 170:240) |>
mutate(predicted_body_mass = predict(penguins_m2, newdata = data.frame(flipper_length_mm)))
bill_length_mm = mean(penguins$bill_depth_mm, na.rm = T)) |>
predicted_data_fl <- data.frame(flipper_length_mm = 170:240,
bill_length_mm = mean(penguins$bill_depth_mm, na.rm = T)) |>
mutate(predicted_body_mass = predict(penguins_m2, newdata = data.frame(flipper_length_mm,
bill_length_mm)))
summary(penguins)
predicted_data_bl <- data.frame(flipper_length_mm = mean(penguins$flipper_length_mm, na.rm = T),
bill_length_mm = 30:60) |>
mutate(predicted_body_mass = predict(penguins_m2, newdata = data.frame(flipper_length_mm,
bill_length_mm)))
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
penguins |>
ggplot(aes(y = body_mass_g, x = flipper_length_mm)) +
geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5, alpha = .33,
linetype = "dashed") +
geom_point() +
geom_line(data = predicted_data_lf,
aes(x = flipper_length_mm, y = predicted_body_mass),
color = "seagreen3", linewidth = 1.5) +
scale_x_continuous(breaks = c(170, 210, 250)) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000), xlim = c(170, 250), clip = "off") +
guides(y = guide_axis(cap = "both"), x = guide_axis(cap = "both")) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
#| echo: false
#| fig-width: 5
#| fig-height: 4
#| fig-align: center
penguins |>
ggplot(aes(y = body_mass_g, x = flipper_length_mm)) +
geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5, alpha = .33,
linetype = "dashed") +
geom_point() +
geom_line(data = predicted_data_fl,
aes(x = flipper_length_mm, y = predicted_body_mass),
color = "seagreen3", linewidth = 1.5) +
scale_x_continuous(breaks = c(170, 210, 250)) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000), xlim = c(170, 250), clip = "off") +
guides(y = guide_axis(cap = "both"), x = guide_axis(cap = "both")) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
predicted_data_fl <- data.frame(flipper_length_mm = 170:240,
bill_length_mm = mean(penguins$bill_length_mm, na.rm = T)) |>
mutate(predicted_body_mass = predict(penguins_m2, newdata = data.frame(flipper_length_mm,
bill_length_mm)))
predicted_data_bl <- data.frame(flipper_length_mm = mean(penguins$flipper_length_mm, na.rm = T),
bill_length_mm = 30:60) |>
mutate(predicted_body_mass = predict(penguins_m2, newdata = data.frame(flipper_length_mm,
bill_length_mm)))
penguins |>
ggplot(aes(y = body_mass_g, x = bill_length_mm)) +
geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5, alpha = .33,
linetype = "dashed") +
geom_point() +
geom_line(data = predicted_data_bl,
aes(x = bill_length_mm, y = predicted_body_mass),
color = "seagreen3", linewidth = 1.5) +
scale_x_continuous(breaks = c(170, 210, 250)) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
#coord_cartesian(ylim = c(2000, 7000), xlim = c(170, 250), clip = "off") +
guides(y = guide_axis(cap = "both"), x = guide_axis(cap = "both")) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
penguins |>
ggplot(aes(y = body_mass_g, x = bill_length_mm)) +
geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5, alpha = .33,
linetype = "dashed") +
geom_point() +
geom_line(data = predicted_data_bl,
aes(x = bill_length_mm, y = predicted_body_mass),
color = "seagreen3", linewidth = 1.5) +
scale_x_continuous(breaks = c(30, 45, 60)) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000), xlim = c(30, 60), clip = "off") +
guides(y = guide_axis(cap = "both"), x = guide_axis(cap = "both")) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
predicted_data_bl
penguins |>
ggplot(aes(y = body_mass_g, x = bill_length_mm)) +
geom_hline(aes(yintercept = mean(body_mass_g, na.rm=T)),
color = "seagreen3", linewidth = 1.5, alpha = .33,
linetype = "dashed") +
geom_point() +
geom_line(data = predicted_data_bl,
aes(x = bill_length_mm, y = predicted_body_mass),
color = "seagreen3", linewidth = 1.5) +
scale_x_continuous(breaks = c(30, 45, 60)) +
scale_y_continuous(breaks = c(2000, 4500, 7000)) +
coord_cartesian(ylim = c(2000, 7000), xlim = c(30, 60), clip = "off") +
guides(y = guide_axis(cap = "both"), x = guide_axis(cap = "both")) +
theme_classic(base_size = 16) +
theme(aspect.ratio = 1)
confint(penguins_m2)
here::here()
students <- rio::import("student_data.csv")
head(students)
str(students)
summary(students)
cor(students$reading_score, students$writing_score)
mean(students$math_score)
m0 <- lm(math_score ~ 1, data = students)
summary(m0)
m1 <- lm(math_score ~ reading_score, data = students)
summary(m1)
students$reading_score |> range()
students |> select(reading_score) |> range()
predict(m1, data.frame(reading_score = 17:100)) # other values (like maybe 10--100) are okay, as long as they are not crazy unrealistic given the actual range of 17--100.
predicted_data <- data.frame(reading_score = 17:100) |>
mutate(predicted_math_score = predict(m1, data.frame(reading_score)))
predicted_data
ggplot(aes(x = reading_score, y = math_score)) +
geom_point()
students |>
ggplot(aes(x = reading_score, y = math_score)) +
geom_point()
students |>
ggplot(aes(x = reading_score, y = math_score)) +
geom_point() +
geom_line(data = predicted_data, aes(y = predicted_math_score))
