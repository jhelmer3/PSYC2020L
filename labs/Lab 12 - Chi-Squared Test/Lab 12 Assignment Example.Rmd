---
title: "PSYC2020L Assignment 12"
author: "[name]"
date: "2025-11-07"
output: html_document
---

## Goals for Review:

* Chi-Squared Tests
* Independent and Paired Sample T-Tests


## Setting Up

### 1) Rename this assignment as "Lab 12 Assignment [Last, First].Rmd" 

### 2) Check and set (if needed) your working directory. If you'd like to load packages with `library()`, please do so in this block. Please load the `tidyverse`!. 
```{r}
here::here()

library(tidyverse)
```

### 3) Download and relocate the leaves.csv file to your folder for this class. Read in the file and display the first few rows of the data. This dataset contains the color (green, red, orange, or brown) and whether a not a leaf had fallen from its tree for 1,000 leaves. Use `mutate()` to change the `color` variable into an factor variable ordered by the leaf changing process (green -> red -> orange -> brown) first.

```{r}
leaves <- rio::import(here::here("labs", "Lab 12 - Chi-Squared Test", "leaves.csv")) |>
  mutate(color = factor(color, levels = c("green", "red", "orange", "brown")))
```


## Chi-Squared Test of Proportions

### 4a) You are a tree researcher, and you would like to better understand leaves changing color in the fall. You've recorded the color of 1000 leaves, and you'd like to test if there is a difference in the frequency of the colors of the leaves. You plan to conduct a Chi-Squared Test of Proportions on the frequency of different color leaves you've observed in your dataset. First, what are the null and alternative hypotheses for this test?

$H_0$: The frequency of leaves of each color is the same in the population.

$H_A$: The frequency of leaves of each color is not the same in the population.

### 4b) What is the expected frequency for leaves of each color? 

250 each.

### 4c) What is your chi-square degrees of freedom and cutoff value?

```{r}
qchisq(.95, 3)
```
$\text{df} = 4 - 1 = 3$, cutoff = `r qchisq(.95, 3) |> round(3)`.

### 4d) What are the observed frequencies of each color?

```{r}
table(leaves$color)
```

### 4e) What is the observed chi-squared statistic?

```{r}
chisq.test(c(94, 104, 513, 289))
```

### 4f) Provide a brief interpretation of these results.

We reject the null in favor of the alternative that there is a difference among the frequencies of these leaf colors in the population.

### 4g) Create a barplot that displays the frequencies of each leaf color.

```{r}
leaves |>
  ggplot(aes(x = color)) +
  geom_bar()
```

## Chi-Squared Test of Independence

### 5a) You now want to see if leaf color and whether or not the leaf had fallen from the tree are independent variables. What are the null and alternative hypotheses for this test?

$H_0$: Leaf color and whether or not the leaf had fallen have no association.

$H_A$: Leaf color and whether or not the leaf had fallen have some association.

### 5b) What are the observed frequencies of each color given whether or not they had fallen?

```{r}
table(leaves$color, leaves$fallen)
```

### 5c) What is the chi-squared statistic for this test?

```{r}
leaves |>
  summarize(.by = c(color, fallen),
            n = n()) |>
  pivot_wider(names_from = fallen, values_from = n) |>
  select(-color) |>
  chisq.test()
```

### 5d) Provide a brief interpretation of these results.

We reject the null in favor of the alternative that there is an association between leaf color and whether or not they had fallen.


## T-Tests

### 6a) Perform an independent sample *t*-test on the difference between Petal Length and Petal Widthh for the `iris` dataset.

```{r}
t.test(iris$Petal.Length, iris$Petal.Width, var.equal = T)
```

### 6b) Perform an paired sample *t*-test on the difference between Petal Length and Petal Width for the `iris` dataset.

```{r}
t.test(iris$Petal.Length, iris$Petal.Width, paired = T, var.equal = T)
```

### 6c) For this data, do you think an indepedent sample or paired sample *t*-test is more appropriate? (Hint: each row of petal measurements was taken on the same flower.)

Paired sample *t*-test would probably be more appropriate because the measurements are from the same flowers.
